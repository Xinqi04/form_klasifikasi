<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kuesioner Klasifikasi Bipolar</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h2>Form Kuesioner (17 Pertanyaan)</h2>
    <form id="predictForm">
      <fieldset class="question-group">
        <legend>1. Seberapa sering Anda merasa sedih?</legend>
        <div class="options-container">
          <label><input type="radio" name="Sadness" value="0" required><span class="option-text">Most-Often</span></label>
          <label><input type="radio" name="Sadness" value="1"><span class="option-text">Seldom</span></label>
          <label><input type="radio" name="Sadness" value="2"><span class="option-text">Sometimes</span></label>
          <label><input type="radio" name="Sadness" value="3"><span class="option-text">Usually</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>2. Seberapa sering Anda merasa euforia atau sangat bahagia secara tiba-tiba?</legend>
        <div class="options-container">
          <label><input type="radio" name="Euphoric" value="0" required><span class="option-text">Most-Often</span></label>
          <label><input type="radio" name="Euphoric" value="1"><span class="option-text">Seldom</span></label>
          <label><input type="radio" name="Euphoric" value="2"><span class="option-text">Sometimes</span></label>
          <label><input type="radio" name="Euphoric" value="3"><span class="option-text">Usually</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>3. Seberapa sering Anda merasa sangat lelah secara emosional atau fisik?</legend>
        <div class="options-container">
          <label><input type="radio" name="Exhausted" value="0" required><span class="option-text">Most-Often</span></label>
          <label><input type="radio" name="Exhausted" value="1"><span class="option-text">Seldom</span></label>
          <label><input type="radio" name="Exhausted" value="2"><span class="option-text">Sometimes</span></label>
          <label><input type="radio" name="Exhausted" value="3"><span class="option-text">Usually</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>4. Seberapa sering Anda mengalami gangguan tidur?</legend>
        <div class="options-container">
          <label><input type="radio" name="Sleep_dissorder" value="0" required><span class="option-text">Most-Often</span></label>
          <label><input type="radio" name="Sleep_dissorder" value="1"><span class="option-text">Seldom</span></label>
          <label><input type="radio" name="Sleep_dissorder" value="2"><span class="option-text">Sometimes</span></label>
          <label><input type="radio" name="Sleep_dissorder" value="3"><span class="option-text">Usually</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>5. Apakah Anda sering mengalami perubahan suasana hati secara tiba-tiba?</legend>
        <div class="options-container center">
          <label><input type="radio" name="Mood_Swing" value="1" required><span class="option-text">YA</span></label>
          <label><input type="radio" name="Mood_Swing" value="0"><span class="option-text">TIDAK</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>6. Apakah Anda pernah berpikiran untuk bunuh diri?</legend>
        <div class="options-container center">
          <label><input type="radio" name="Suicidal_thoughts" value="1" required><span class="option-text">YA</span></label>
          <label><input type="radio" name="Suicidal_thoughts" value="0"><span class="option-text">TIDAK</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>7. Apakah Anda pernah mengalami kehilangan nafsu makan yang ekstrem (anoreksia)?</legend>
        <div class="options-container center">
          <label><input type="radio" name="Anorxia" value="1" required><span class="option-text">YA</span></label>
          <label><input type="radio" name="Anorxia" value="0"><span class="option-text">TIDAK</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>8. Apakah Anda menghormati atau mengikuti otoritas (seperti guru, orang tua, atau pemimpin)?</legend>
        <div class="options-container center">
          <label><input type="radio" name="Authority_Respect" value="1" required><span class="option-text">YA</span></label>
          <label><input type="radio" name="Authority_Respect" value="0"><span class="option-text">TIDAK</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>9. Jika Anda melakukan kesalahan, apakah Anda cenderung mencoba memberikan penjelasan?</legend>
        <div class="options-container center">
          <label><input type="radio" name="Try_Explanation" value="1" required><span class="option-text">YA</span></label>
          <label><input type="radio" name="Try_Explanation" value="0"><span class="option-text">TIDAK</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>10. Apakah Anda sering menunjukkan respons agresif saat merasa diserang secara emosional?</legend>
        <div class="options-container center">
          <label><input type="radio" name="Aggressive_Response" value="1" required><span class="option-text">YA</span></label>
          <label><input type="radio" name="Aggressive_Response" value="0"><span class="option-text">TIDAK</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>11. Apakah Anda lebih memilih untuk mengabaikan masalah dan melanjutkan hidup?</legend>
        <div class="options-container center">
          <label><input type="radio" name="Ignore_Move_On" value="1" required><span class="option-text">YA</span></label>
          <label><input type="radio" name="Ignore_Move_On" value="0"><span class="option-text">TIDAK</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>12. Pernahkah Anda mengalami gangguan saraf atau kelelahan mental yang ekstrem?</legend>
        <div class="options-container center">
          <label><input type="radio" name="Nervous_Break_down" value="1" required><span class="option-text">YA</span></label>
          <label><input type="radio" name="Nervous_Break_down" value="0"><span class="option-text">TIDAK</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>13. Apakah Anda berani mengakui kesalahan Anda kepada orang lain?</legend>
        <div class="options-container center">
          <label><input type="radio" name="Admit_Mistakes" value="1" required><span class="option-text">YA</span></label>
          <label><input type="radio" name="Admit_Mistakes" value="0"><span class="option-text">TIDAK</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>14. Apakah Anda sering overthinking?</legend>
        <div class="options-container center">
          <label><input type="radio" name="Overthinking" value="1" required><span class="option-text">YA</span></label>
          <label><input type="radio" name="Overthinking" value="0"><span class="option-text">TIDAK</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>15. Seberapa sering Anda melakukan aktivitas seksual?</legend>
        <div class="options-container">
          <label><input type="radio" name="Sexual_Activity" value="0" required><span class="option-text">1</span></label>
          <label><input type="radio" name="Sexual_Activity" value="1"><span class="option-text">2</span></label>
          <label><input type="radio" name="Sexual_Activity" value="2"><span class="option-text">3</span></label>
          <label><input type="radio" name="Sexual_Activity" value="3"><span class="option-text">4</span></label>
          <label><input type="radio" name="Sexual_Activity" value="4"><span class="option-text">5</span></label>
          <label><input type="radio" name="Sexual_Activity" value="5"><span class="option-text">6</span></label>
          <label><input type="radio" name="Sexual_Activity" value="6"><span class="option-text">7</span></label>
          <label><input type="radio" name="Sexual_Activity" value="7"><span class="option-text">8</span></label>
          <label><input type="radio" name="Sexual_Activity" value="8"><span class="option-text">9</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>16. Seberapa baik konsentrasi Anda?</legend>
        <div class="options-container">
          <label><input type="radio" name="Concentration" value="0" required><span class="option-text">1</span></label>
          <label><input type="radio" name="Concentration" value="1"><span class="option-text">2</span></label>
          <label><input type="radio" name="Concentration" value="2"><span class="option-text">3</span></label>
          <label><input type="radio" name="Concentration" value="3"><span class="option-text">4</span></label>
          <label><input type="radio" name="Concentration" value="4"><span class="option-text">5</span></label>
          <label><input type="radio" name="Concentration" value="5"><span class="option-text">6</span></label>
          <label><input type="radio" name="Concentration" value="6"><span class="option-text">7</span></label>
          <label><input type="radio" name="Concentration" value="7"><span class="option-text">8</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>17. Seberapa tinggi tingkat optimisme Anda terhadap masa depan?</legend>
        <div class="options-container">
          <label><input type="radio" name="Optimisim" value="0" required><span class="option-text">1</span></label>
          <label><input type="radio" name="Optimisim" value="1"><span class="option-text">2</span></label>
          <label><input type="radio" name="Optimisim" value="2"><span class="option-text">3</span></label>
          <label><input type="radio" name="Optimisim" value="3"><span class="option-text">4</span></label>
          <label><input type="radio" name="Optimisim" value="4"><span class="option-text">5</span></label>
          <label><input type="radio" name="Optimisim" value="5"><span class="option-text">6</span></label>
          <label><input type="radio" name="Optimisim" value="6"><span class="option-text">7</span></label>
          <label><input type="radio" name="Optimisim" value="7"><span class="option-text">8</span></label>
          <!-- <label><input type="radio" name="Optimisim" value="8"><span class="option-text">9</span></label> -->
        </div>
      </fieldset>

      <button type="submit" class="submit-button">Submit</button>
    </form>

    <div id="resultContainer" class="hidden">
      <p id="resultText"></p>
    </div>
  </div>

  <script>
    // Pastikan nama input sesuai dengan yang diharapkan API (urutan penting)
    const questionOrder = [
      "Sadness", "Euphoric", "Exhausted", "Sleep_dissorder", "Mood_Swing",
      "Suicidal_thoughts", "Anorxia", "Authority_Respect", "Try_Explanation",
      "Aggressive_Response", "Ignore_Move_On", "Nervous_Break_down",
      "Admit_Mistakes", "Overthinking", "Sexual_Activity", "Concentration", "Optimisim"
    ];

    document.getElementById("predictForm").addEventListener("submit", async function(e) {
      e.preventDefault();
      const resultContainer = document.getElementById("resultContainer");
      const resultText = document.getElementById("resultText");
      const submitButton = e.target.querySelector('.submit-button');

      resultText.textContent = "Memproses...";
      resultContainer.className = "loading"; 
      resultContainer.classList.remove("hidden");
      submitButton.disabled = true;
      submitButton.textContent = "Memproses...";

      const dataArray = [];
      let allAnswered = true;

      for (const name of questionOrder) {
        const selectedOption = document.querySelector(`input[name="${name}"]:checked`);
        if (selectedOption) {
          dataArray.push(parseInt(selectedOption.value));
        } else {
          allAnswered = false;
          break;
        }
      }

      if (!allAnswered) {
        resultText.textContent = "Harap jawab semua pertanyaan sebelum mengirim.";
        resultContainer.className = "error";
        submitButton.disabled = false;
        submitButton.textContent = "Submit";
        return;
      }

      if (dataArray.length !== 17) {
        resultText.textContent = "Terjadi kesalahan dalam pengumpulan data. Pastikan semua 17 pertanyaan terjawab.";
        resultContainer.className = "error";
        submitButton.disabled = false;
        submitButton.textContent = "Submit";
        return;
      }

      try {
        const response = await fetch("https://rizaaf-fastapi-classifier.hf.space/predict", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ data: dataArray })
        });

        if (!response.ok) {
          let errorDetail = "Gagal memproses respons error dari server.";
          try {
            const errorData = await response.json();
            errorDetail = errorData.detail || `Error ${response.status}`;
          } catch (jsonError) {
            // Biarkan errorDetail default jika parsing JSON gagal
          }
          throw new Error(`Server merespons: ${errorDetail}`);
        }

        const result = await response.json();

        if (result && result.label) {
          resultText.textContent = `Hasil Klasifikasi: ${result.label}`;
          resultContainer.className = "success";
        } else {
          resultText.textContent = "Format respons tidak dikenali dari server.";
          resultContainer.className = "error";
        }

      } catch (error) {
        console.error("Error:", error);
        resultText.textContent = `Terjadi kesalahan: ${error.message}. Silakan coba lagi.`;
        resultContainer.className = "error";
      } finally {
            submitButton.disabled = false;
            submitButton.textContent = "Submit";
      }
    });
  </script>
</body>
</html>