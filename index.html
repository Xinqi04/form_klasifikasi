<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kuesioner Klasifikasi Kondisi</title>
  <!-- Asumsi style.css ada dan sudah benar -->
  <link rel="stylesheet" href="style.css">
  <style>
    /* Tambahan CSS sederhana untuk memastikan elemen hasil terlihat jika style.css tidak lengkap */
    .hidden { display: none; }
    #resultContainer { margin-top: 20px; padding: 15px; border: 1px solid #ccc; background-color: #f9f9f9; border-radius: 5px; }
    #resultText { font-weight: bold; }
    .loading { color: #007bff; }
    .error { color: red; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Form Kuesioner (17 Pertanyaan)</h2>
    <form id="predictForm">
      <fieldset class="question-group">
        <legend>1. Seberapa sering Anda merasa sedih?</legend>
        <div class="options-container">
          <label><input type="radio" name="Sadness" value="0" required><span class="option-text">Most-Often</span></label>
          <label><input type="radio" name="Sadness" value="1"><span class="option-text">Seldom</span></label>
          <label><input type="radio" name="Sadness" value="2"><span class="option-text">Sometimes</span></label>
          <label><input type="radio" name="Sadness" value="3"><span class="option-text">Usually</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>2. Seberapa sering Anda merasa euforia atau sangat bahagia secara tiba-tiba?</legend>
        <div class="options-container">
          <label><input type="radio" name="Euphoric" value="0" required><span class="option-text">Most-Often</span></label>
          <label><input type="radio" name="Euphoric" value="1"><span class="option-text">Seldom</span></label>
          <label><input type="radio" name="Euphoric" value="2"><span class="option-text">Sometimes</span></label>
          <label><input type="radio" name="Euphoric" value="3"><span class="option-text">Usually</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>3. Seberapa sering Anda merasa sangat lelah secara emosional atau fisik?</legend>
        <div class="options-container">
          <label><input type="radio" name="Exhausted" value="0" required><span class="option-text">Most-Often</span></label>
          <label><input type="radio" name="Exhausted" value="1"><span class="option-text">Seldom</span></label>
          <label><input type="radio" name="Exhausted" value="2"><span class="option-text">Sometimes</span></label>
          <label><input type="radio" name="Exhausted" value="3"><span class="option-text">Usually</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>4. Seberapa sering Anda mengalami gangguan tidur?</legend>
        <div class="options-container">
          <label><input type="radio" name="Sleep_dissorder" value="0" required><span class="option-text">Most-Often</span></label>
          <label><input type="radio" name="Sleep_dissorder" value="1"><span class="option-text">Seldom</span></label>
          <label><input type="radio" name="Sleep_dissorder" value="2"><span class="option-text">Sometimes</span></label>
          <label><input type="radio" name="Sleep_dissorder" value="3"><span class="option-text">Usually</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>5. Apakah Anda sering mengalami perubahan suasana hati secara tiba-tiba?</legend>
        <div class="options-container center">
          <label><input type="radio" name="Mood_Swing" value="1" required><span class="option-text">YA</span></label>
          <label><input type="radio" name="Mood_Swing" value="0"><span class="option-text">TIDAK</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>6. Apakah Anda pernah berpikiran untuk bunuh diri?</legend>
        <div class="options-container center">
          <label><input type="radio" name="Suicidal_thoughts" value="1" required><span class="option-text">YA</span></label>
          <label><input type="radio" name="Suicidal_thoughts" value="0"><span class="option-text">TIDAK</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>7. Apakah Anda pernah mengalami kehilangan nafsu makan yang ekstrem (anoreksia)?</legend>
        <div class="options-container center">
          <label><input type="radio" name="Anorxia" value="1" required><span class="option-text">YA</span></label> <!-- Typo Anorxia dipertahankan jika API dilatih dengan ini -->
          <label><input type="radio" name="Anorxia" value="0"><span class="option-text">TIDAK</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>8. Apakah Anda menghormati atau mengikuti otoritas (seperti guru, orang tua, atau pemimpin)?</legend>
        <div class="options-container center">
          <label><input type="radio" name="Authority_Respect" value="1" required><span class="option-text">YA</span></label>
          <label><input type="radio" name="Authority_Respect" value="0"><span class="option-text">TIDAK</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>9. Jika Anda melakukan kesalahan, apakah Anda cenderung mencoba memberikan penjelasan?</legend>
        <div class="options-container center">
          <label><input type="radio" name="Try_Explanation" value="1" required><span class="option-text">YA</span></label>
          <label><input type="radio" name="Try_Explanation" value="0"><span class="option-text">TIDAK</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>10. Apakah Anda sering menunjukkan respons agresif saat merasa diserang secara emosional?</legend>
        <div class="options-container center">
          <label><input type="radio" name="Aggressive_Response" value="1" required><span class="option-text">YA</span></label>
          <label><input type="radio" name="Aggressive_Response" value="0"><span class="option-text">TIDAK</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>11. Apakah Anda lebih memilih untuk mengabaikan masalah dan melanjutkan hidup?</legend>
        <div class="options-container center">
          <label><input type="radio" name="Ignore_Move_On" value="1" required><span class="option-text">YA</span></label>
          <label><input type="radio" name="Ignore_Move_On" value="0"><span class="option-text">TIDAK</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>12. Pernahkah Anda mengalami gangguan saraf atau kelelahan mental yang ekstrem?</legend>
        <div class="options-container center">
          <label><input type="radio" name="Nervous_Break_down" value="1" required><span class="option-text">YA</span></label>
          <label><input type="radio" name="Nervous_Break_down" value="0"><span class="option-text">TIDAK</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>13. Apakah Anda berani mengakui kesalahan Anda kepada orang lain?</legend>
        <div class="options-container center">
          <label><input type="radio" name="Admit_Mistakes" value="1" required><span class="option-text">YA</span></label>
          <label><input type="radio" name="Admit_Mistakes" value="0"><span class="option-text">TIDAK</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>14. Apakah Anda sering overthinking?</legend>
        <div class="options-container center">
          <label><input type="radio" name="Overthinking" value="1" required><span class="option-text">YA</span></label>
          <label><input type="radio" name="Overthinking" value="0"><span class="option-text">TIDAK</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>15. Seberapa sering Anda melakukan aktivitas seksual? (Skala 1-9, di mana 1 = sangat jarang, 9 = sangat sering)</legend>
        <div class="options-container">
          <label><input type="radio" name="Sexual_Activity" value="0" required><span class="option-text">1</span></label>
          <label><input type="radio" name="Sexual_Activity" value="1"><span class="option-text">2</span></label>
          <label><input type="radio" name="Sexual_Activity" value="2"><span class="option-text">3</span></label>
          <label><input type="radio" name="Sexual_Activity" value="3"><span class="option-text">4</span></label>
          <label><input type="radio" name="Sexual_Activity" value="4"><span class="option-text">5</span></label>
          <label><input type="radio" name="Sexual_Activity" value="5"><span class="option-text">6</span></label>
          <label><input type="radio" name="Sexual_Activity" value="6"><span class="option-text">7</span></label>
          <label><input type="radio" name="Sexual_Activity" value="7"><span class="option-text">8</span></label>
          <label><input type="radio" name="Sexual_Activity" value="8"><span class="option-text">9</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>16. Seberapa baik konsentrasi Anda? (Skala 1-8, di mana 1 = sangat buruk, 8 = sangat baik)</legend>
        <div class="options-container">
          <label><input type="radio" name="Concentration" value="0" required><span class="option-text">1</span></label>
          <label><input type="radio" name="Concentration" value="1"><span class="option-text">2</span></label>
          <label><input type="radio" name="Concentration" value="2"><span class="option-text">3</span></label>
          <label><input type="radio" name="Concentration" value="3"><span class="option-text">4</span></label>
          <label><input type="radio" name="Concentration" value="4"><span class="option-text">5</span></label>
          <label><input type="radio" name="Concentration" value="5"><span class="option-text">6</span></label>
          <label><input type="radio" name="Concentration" value="6"><span class="option-text">7</span></label>
          <label><input type="radio" name="Concentration" value="7"><span class="option-text">8</span></label>
        </div>
      </fieldset>

      <fieldset class="question-group">
        <legend>17. Seberapa tinggi tingkat optimisme Anda terhadap masa depan? (Skala 1-8, di mana 1 = sangat rendah, 8 = sangat tinggi)</legend>
        <div class="options-container">
          <label><input type="radio" name="Optimisim" value="0" required><span class="option-text">1</span></label> <!-- Typo Optimisim dipertahankan -->
          <label><input type="radio" name="Optimisim" value="1"><span class="option-text">2</span></label>
          <label><input type="radio" name="Optimisim" value="2"><span class="option-text">3</span></label>
          <label><input type="radio" name="Optimisim" value="3"><span class="option-text">4</span></label>
          <label><input type="radio" name="Optimisim" value="4"><span class="option-text">5</span></label>
          <label><input type="radio" name="Optimisim" value="5"><span class="option-text">6</span></label>
          <label><input type="radio" name="Optimisim" value="6"><span class="option-text">7</span></label>
          <label><input type="radio" name="Optimisim" value="7"><span class="option-text">8</span></label>
        </div>
      </fieldset>

      <button type="submit" class="submit-button">Prediksi Kondisi</button>
    </form>

    <div id="resultContainer" class="hidden">
      <p id="resultText"></p>
    </div>
  </div>

  <script>
    const form = document.getElementById("predictForm");
    const resultContainer = document.getElementById("resultContainer");
    const resultText = document.getElementById("resultText");

    // Daftar nama-nama input (sesuai dengan atribut `name` dari setiap radio button, dalam urutan yang benar)
    const orderedFeatureNames = [
      "Sadness", "Euphoric", "Exhausted", "Sleep_dissorder",
      "Mood_Swing", "Suicidal_thoughts", "Anorxia", "Authority_Respect",
      "Try_Explanation", "Aggressive_Response", "Ignore_Move_On",
      "Nervous_Break_down", "Admit_Mistakes", "Overthinking",
      "Sexual_Activity", "Concentration", "Optimisim" 
      // Pastikan ini 17 nama dan urutannya sesuai dengan yang diharapkan model API.
      // Typo seperti "Anorxia" dan "Optimisim" dipertahankan jika model dilatih dengan nama tersebut.
      // Jika tidak, sesuaikan nama ini DAN di HTML.
    ];

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      resultText.textContent = "Memproses...";
      resultText.className = 'loading'; // Tambahkan class untuk styling loading
      resultContainer.classList.remove("hidden");

      // Ambil nilai dari masing-masing input radio yang dipilih
      const features = orderedFeatureNames.map(name => {
        const selectedRadio = form.querySelector(`input[name="${name}"]:checked`);
        return selectedRadio ? parseFloat(selectedRadio.value) : NaN; // Gunakan parseFloat untuk konsistensi
      });

      // Validasi apakah semua pertanyaan telah dijawab
      if (features.some(isNaN)) {
        resultText.textContent = "Pastikan semua 17 pertanyaan telah dijawab.";
        resultText.className = 'error'; // Tambahkan class untuk styling error
        return;
      }

      console.log("Fitur yang dikirim:", features); // Untuk debugging

      try {
        const response = await fetch("https://rizaaf-klasifikasi-tf.hf.space/predict", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({ features: features }) // API mengharapkan objek dengan key 'features'
        });

        if (!response.ok) {
          // Coba baca detail error jika ada dari server
          let errorDetail = `Server error: ${response.status}`;
          try {
            const errorData = await response.json();
            if (errorData && errorData.detail) {
              errorDetail = `Error dari server: ${errorData.detail}`;
            }
          } catch (jsonError) {
            // Biarkan errorDetail yang sudah ada
          }
          throw new Error(errorDetail);
        }

        const data = await response.json();

        // Tampilkan hasil prediksi
        resultText.textContent = `Kondisi: ${data.kondisi}, Keyakinan: ${Math.round(data.confidence * 100)}%`;
        resultText.className = ''; // Hapus class error/loading
        
      } catch (error) {
        console.error("Error saat prediksi:", error);
        resultText.textContent = "Error: " + error.message;
        resultText.className = 'error'; // Tambahkan class untuk styling error
      }
    });
  </script>

</body>
</html>
